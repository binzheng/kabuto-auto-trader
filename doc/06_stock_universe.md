# 日本株自動売買システム - 銘柄リスト（Stock Universe）設計

## 概要

本文書では、全自動売買システムに適した日本株の銘柄選定基準と、推奨銘柄リストを定義します。**流動性・安定性・自動売買適性**を重視した選定を行います。

---

## 1. 銘柄選定の基本方針

### 1.1 選定における3つの優先事項

```yaml
priority:
  1. 流動性確保:
     - スリッページ最小化
     - 成行注文の即時約定
     - 板の厚み（売買代金10億円以上/日）

  2. 価格安定性:
     - 極端なボラティリティを回避
     - ストップ高/安の頻度が低い
     - 仕手株・材料株を除外

  3. 自動売買適性:
     - テクニカル分析が機能しやすい
     - 企業イベント（決算・株式分割等）の影響を考慮
     - 取引時間中の流動性が一定
```

---

## 2. 定量的選定基準

### 2.1 必須条件（Hard Criteria）

| 項目 | 基準値 | 理由 |
|------|--------|------|
| **時価総額** | ≥ 1,000億円 | 大型株のみ対象、流動性確保 |
| **日次出来高** | ≥ 100万株 | 板の厚み、即時約定可能性 |
| **日次売買代金** | ≥ 10億円 | スリッページ最小化 |
| **株価** | 500円 ≤ P ≤ 15,000円 | 低位株・値嵩株を除外 |
| **単元株数** | 100株 | 標準的な取引単位 |
| **上場年数** | ≥ 3年 | 安定性、データ蓄積 |

### 2.2 推奨条件（Soft Criteria）

| 項目 | 基準値 | 理由 |
|------|--------|------|
| **ボラティリティ** | 1.5% ≤ 日次変動率 ≤ 4.0% | 適度な値動き、過度な変動を回避 |
| **スプレッド** | ≤ 0.3% | 取引コスト最小化 |
| **流動性比率** | 出来高 / 発行済株式 ≥ 0.1% | 取引のしやすさ |
| **指数構成銘柄** | 日経225 または TOPIX Core30 | 流動性・情報透明性 |
| **配当利回り** | 任意（優先度低） | 短期売買には影響小 |

---

## 3. 除外条件（Exclusion Criteria）

### 3.1 絶対除外（Absolute Exclusion）

```yaml
exclude_absolute:
  # 市場区分
  - 新興市場（グロース市場）全銘柄
  - 上場廃止予定銘柄
  - 監理銘柄・整理銘柄

  # 価格帯
  - 低位株（500円未満）
  - 超値嵩株（15,000円超）

  # 流動性
  - 日次出来高 < 50万株
  - 日次売買代金 < 5億円

  # 企業状態
  - 直近3ヶ月以内の株式分割・併合予定
  - 直近1ヶ月以内のIPO銘柄
  - 破産手続き中・経営再建中
```

### 3.2 慎重判断（Conditional Exclusion）

```yaml
exclude_conditional:
  # 高ボラティリティ
  - 過去30日間で3回以上のストップ高/安
  - 日次変動率の標準偏差 > 5%

  # イベントリスク
  - 決算発表日の前後3営業日
  - 株主総会当日
  - 大型M&A発表後1週間

  # セクター集中
  - 同一セクターで既に2銘柄保有中
  - 相関係数 > 0.7 の銘柄（分散不足）

  # 特殊要因
  - TOB（公開買付）対象銘柄
  - 仕手株の可能性（急激な出来高増加）
  - ニュース・材料による急騰/急落中
```

---

## 4. 推奨銘柄リスト

### 4.1 TOPIX Core30 から選定（Tier 1）

**選定理由：** 日本を代表する超大型株、最高の流動性、情報透明性

| コード | 銘柄名 | セクター | 時価総額 | 日次売買代金 | 推奨度 |
|--------|--------|----------|----------|--------------|--------|
| **9984** | ソフトバンクグループ | 通信 | 約11兆円 | 200億円+ | ⭐⭐⭐⭐⭐ |
| **6758** | ソニーグループ | 電機 | 約17兆円 | 150億円+ | ⭐⭐⭐⭐⭐ |
| **7203** | トヨタ自動車 | 自動車 | 約45兆円 | 180億円+ | ⭐⭐⭐⭐⭐ |
| **9433** | KDDI | 通信 | 約9兆円 | 80億円+ | ⭐⭐⭐⭐⭐ |
| **8306** | 三菱UFJ | 金融 | 約17兆円 | 120億円+ | ⭐⭐⭐⭐ |
| **6861** | キーエンス | 電機 | 約20兆円 | 100億円+ | ⭐⭐⭐⭐⭐ |
| **8035** | 東京エレクトロン | 電機 | 約15兆円 | 130億円+ | ⭐⭐⭐⭐⭐ |
| **4063** | 信越化学工業 | 化学 | 約9兆円 | 60億円+ | ⭐⭐⭐⭐ |
| **6098** | リクルートホールディングス | サービス | 約11兆円 | 90億円+ | ⭐⭐⭐⭐ |
| **4568** | 第一三共 | 医薬品 | 約7兆円 | 70億円+ | ⭐⭐⭐⭐ |

**Tier 1 の特徴：**
- 売買代金が極めて大きい（50億円以上/日）
- スプレッドが極めて狭い（< 0.1%）
- グローバル企業、情報開示が充実
- テクニカル分析が機能しやすい

### 4.2 日経225 から選定（Tier 2）

**選定理由：** 高い流動性、中〜大型株、セクター分散

| コード | 銘柄名 | セクター | 時価総額 | 日次売買代金 | 推奨度 |
|--------|--------|----------|----------|--------------|--------|
| **8316** | 三井住友FG | 金融 | 約8兆円 | 80億円+ | ⭐⭐⭐⭐ |
| **9434** | ソフトバンク | 通信 | 約7兆円 | 70億円+ | ⭐⭐⭐⭐ |
| **6902** | デンソー | 自動車部品 | 約6兆円 | 50億円+ | ⭐⭐⭐ |
| **4502** | 武田薬品工業 | 医薬品 | 約7兆円 | 60億円+ | ⭐⭐⭐⭐ |
| **6501** | 日立製作所 | 電機 | 約8兆円 | 70億円+ | ⭐⭐⭐⭐ |
| **8058** | 三菱商事 | 商社 | 約12兆円 | 90億円+ | ⭐⭐⭐⭐ |
| **9432** | NTT | 通信 | 約3兆円 | 40億円+ | ⭐⭐⭐ |
| **7267** | ホンダ | 自動車 | 約10兆円 | 60億円+ | ⭐⭐⭐⭐ |
| **6367** | ダイキン工業 | 機械 | 約7兆円 | 50億円+ | ⭐⭐⭐ |
| **4755** | 楽天グループ | ネット | 約1兆円 | 80億円+ | ⭐⭐⭐ |

**Tier 2 の特徴：**
- 売買代金が大きい（30-100億円/日）
- セクター分散に有効
- 配当株・成長株のバランス

---

## 5. セクター別推奨銘柄

### 5.1 セクター分類と推奨銘柄数

```yaml
sector_allocation:
  電機・エレクトロニクス:
    max_holdings: 2
    recommended: [6758, 6861, 8035, 6501]
    reason: "高ボラティリティ、トレンド継続性高い"

  自動車:
    max_holdings: 1
    recommended: [7203, 7267]
    reason: "安定性高い、グローバル需要に連動"

  金融:
    max_holdings: 1
    recommended: [8306, 8316]
    reason: "大型株、低ボラ、配当安定"

  通信:
    max_holdings: 1
    recommended: [9433, 9434]
    reason: "ディフェンシブ、出来高安定"

  医薬品:
    max_holdings: 1
    recommended: [4568, 4502]
    reason: "景気中立、バイオ関連は高ボラ"

  化学:
    max_holdings: 1
    recommended: [4063]
    reason: "世界的企業、材料株の側面あり"

  商社:
    max_holdings: 1
    recommended: [8058]
    reason: "資源価格連動、ボラティリティあり"

  サービス・IT:
    max_holdings: 1
    recommended: [6098, 4755]
    reason: "成長株、値動き活発"
```

**セクター分散の重要性：**
- 同一セクター集中でシステマティックリスク増大
- 相関の低いセクター組み合わせでドローダウン抑制
- 推奨：最大5銘柄保有時、5つの異なるセクターから選択

---

## 6. 銘柄選定フローチャート

```
┌─────────────────────────────────────┐
│   候補銘柄リスト（全上場銘柄）       │
└──────────────┬──────────────────────┘
               │
               ▼
      【ステップ1: 市場区分フィルター】
      プライム市場のみ？
               │
         Yes   │   No → 除外
               ▼
      【ステップ2: 指数構成銘柄フィルター】
      日経225 または TOPIX Core30？
               │
         Yes   │   No → Tier3（慎重検討）
               ▼
      【ステップ3: 流動性フィルター】
      ・時価総額 ≥ 1000億円
      ・日次出来高 ≥ 100万株
      ・日次売買代金 ≥ 10億円
               │
         Yes   │   No → 除外
               ▼
      【ステップ4: 価格帯フィルター】
      500円 ≤ 株価 ≤ 15,000円？
               │
         Yes   │   No → 除外
               ▼
      【ステップ5: ボラティリティフィルター】
      1.5% ≤ 日次変動率 ≤ 4.0%？
               │
         Yes   │   No → 低優先度
               ▼
      【ステップ6: 除外条件チェック】
      ・株式分割予定なし
      ・ストップ高/安頻発なし
      ・仕手株判定なし
               │
         OK    │   NG → 除外
               ▼
      【ステップ7: イベントリスクチェック】
      ・決算発表日 ± 3営業日外
      ・TOB対象外
      ・急騰/急落中でない
               │
         OK    │   NG → 一時除外
               ▼
      【ステップ8: セクター分散チェック】
      同一セクター保有数 < 2？
               │
         Yes   │   No → 低優先度
               ▼
┌──────────────────────────────────────┐
│        承認済み銘柄リスト              │
│  （Tier 1: 10銘柄 / Tier 2: 10銘柄） │
└──────────────────────────────────────┘
```

---

## 7. 動的銘柄リスト管理

### 7.1 定期見直しスケジュール

```yaml
review_schedule:
  daily:
    - 出来高・売買代金の確認
    - ストップ高/安の検知
    - 決算発表スケジュール確認

  weekly:
    - ボラティリティの再計算
    - セクター別パフォーマンスレビュー
    - 新規候補銘柄のスクリーニング

  monthly:
    - 全銘柄の定量基準再評価
    - 除外銘柄の復活可否判定
    - 銘柄リストの最適化

  quarterly:
    - 指数構成銘柄の入替確認
    - 市場環境に応じた基準値調整
    - バックテスト結果との照合
```

### 7.2 自動除外トリガー

```python
# server/universe_manager.py
from datetime import datetime, timedelta

class UniverseManager:
    """銘柄リスト管理"""

    def check_auto_exclusion(self, ticker: str) -> tuple[bool, str]:
        """自動除外条件のチェック"""

        # 1. 流動性チェック
        recent_volume = self.get_average_volume(ticker, days=20)
        if recent_volume < 1_000_000:
            return True, f"出来高不足: {recent_volume:,}株/日"

        # 2. 売買代金チェック
        recent_turnover = self.get_average_turnover(ticker, days=20)
        if recent_turnover < 1_000_000_000:
            return True, f"売買代金不足: ¥{recent_turnover:,}/日"

        # 3. ストップ高/安チェック
        stop_count = self.count_price_limits(ticker, days=30)
        if stop_count >= 3:
            return True, f"過去30日間で{stop_count}回のストップ高/安"

        # 4. 決算イベントチェック
        if self.is_earnings_period(ticker, buffer_days=3):
            return True, "決算発表期間中"

        # 5. 株式分割チェック
        if self.has_upcoming_stock_split(ticker, days_ahead=90):
            return True, "株式分割予定あり"

        return False, "OK"

    def get_current_universe(self) -> list[str]:
        """現在の承認済み銘柄リストを取得"""
        tier1 = ["9984", "6758", "7203", "9433", "8306",
                 "6861", "8035", "4063", "6098", "4568"]

        tier2 = ["8316", "9434", "6902", "4502", "6501",
                 "8058", "9432", "7267", "6367", "4755"]

        # 除外条件チェック
        approved = []
        for ticker in tier1 + tier2:
            should_exclude, reason = self.check_auto_exclusion(ticker)
            if not should_exclude:
                approved.append(ticker)
            else:
                logger.warning(f"銘柄除外: {ticker} - {reason}")

        return approved
```

---

## 8. 価格帯別の注意事項

### 8.1 低価格帯（500-1,500円）

**該当銘柄例:** 楽天G（約700円）、三菱UFJ（約1,200円）

**特徴:**
- スプレッドの影響が相対的に大きい（絶対額は小さい）
- 単元株（100株）での取引がしやすい
- ボラティリティが相対的に高め

**推奨設定:**
- ATR倍率を若干大きめに（SL: 2.5倍、TP: 5.0倍）
- ポジションサイズを大きめに設定可能

### 8.2 中価格帯（1,500-5,000円）

**該当銘柄例:** ソフトバンクG（約3,000円）、ソニーG（約3,500円）

**特徴:**
- 最もバランスが良い価格帯
- 流動性・ボラティリティが適度
- テクニカル分析が最も機能しやすい

**推奨設定:**
- 標準設定（SL: 2.0倍、TP: 4.0倍）
- 最優先候補

### 8.3 高価格帯（5,000-15,000円）

**該当銘柄例:** キーエンス（約7万円）※、東京エレクトロン（約2.5万円）

**特徴:**
- 1単元の購入金額が大きい（100万円超も）
- スプレッドの絶対額が大きい
- 資金効率が悪い（少額運用には不向き）

**推奨設定:**
- ポジションサイズを小さめに
- 口座資金300万円以上推奨
- ATR倍率を標準的に維持

**注:** キーエンス（6861）は約7万円と非常に高額ですが、流動性が極めて高いため例外的に推奨リストに含めています。少額運用の場合は除外を検討してください。

---

## 9. 銘柄リスト実装例

### 9.1 設定ファイル（YAML形式）

```yaml
# config/universe.yaml

stock_universe:
  tier1:
    - ticker: "9984"
      name: "ソフトバンクグループ"
      sector: "通信"
      weight: 1.2  # 優先度加重

    - ticker: "6758"
      name: "ソニーグループ"
      sector: "電機"
      weight: 1.2

    - ticker: "7203"
      name: "トヨタ自動車"
      sector: "自動車"
      weight: 1.0

    - ticker: "9433"
      name: "KDDI"
      sector: "通信"
      weight: 1.0

    - ticker: "8306"
      name: "三菱UFJ"
      sector: "金融"
      weight: 0.8

    - ticker: "6861"
      name: "キーエンス"
      sector: "電機"
      weight: 1.1
      notes: "高額株、資金要注意"

    - ticker: "8035"
      name: "東京エレクトロン"
      sector: "電機"
      weight: 1.1

    - ticker: "4063"
      name: "信越化学工業"
      sector: "化学"
      weight: 0.9

    - ticker: "6098"
      name: "リクルートHD"
      sector: "サービス"
      weight: 1.0

    - ticker: "4568"
      name: "第一三共"
      sector: "医薬品"
      weight: 0.9

  criteria:
    min_market_cap: 100_000_000_000      # 1000億円
    min_daily_volume: 1_000_000          # 100万株
    min_daily_turnover: 1_000_000_000    # 10億円
    min_price: 500
    max_price: 15_000
    min_volatility: 0.015                # 1.5%
    max_volatility: 0.040                # 4.0%
    max_same_sector: 2
```

### 9.2 銘柄選択ロジック（Python）

```python
# server/stock_selector.py
import yaml
import random

class StockSelector:
    def __init__(self, config_path: str):
        with open(config_path, 'r') as f:
            self.config = yaml.safe_load(f)
        self.universe = self.config['stock_universe']['tier1']

    def select_stocks(self, max_stocks: int = 5) -> list[str]:
        """最大max_stocks銘柄を選択（セクター分散考慮）"""

        # 除外チェック済み銘柄のみ
        universe_manager = UniverseManager()
        approved_tickers = []

        for stock in self.universe:
            ticker = stock['ticker']
            should_exclude, _ = universe_manager.check_auto_exclusion(ticker)
            if not should_exclude:
                approved_tickers.append(stock)

        # 重み付けランダム選択（セクター制限あり）
        selected = []
        sector_count = {}

        # 重みでソート
        candidates = sorted(approved_tickers,
                          key=lambda x: x['weight'],
                          reverse=True)

        for stock in candidates:
            if len(selected) >= max_stocks:
                break

            sector = stock['sector']
            if sector_count.get(sector, 0) >= 2:
                continue  # 同一セクター2銘柄まで

            selected.append(stock['ticker'])
            sector_count[sector] = sector_count.get(sector, 0) + 1

        return selected

# 使用例
selector = StockSelector('config/universe.yaml')
today_stocks = selector.select_stocks(max_stocks=5)
print(f"本日の対象銘柄: {today_stocks}")
# 出力例: ['9984', '6758', '7203', '9433', '4063']
```

---

## 10. 銘柄リスト最適化のベストプラクティス

### 10.1 推奨事項

1. **初期運用は3-5銘柄から開始**
   - Tier 1 から高流動性銘柄のみ選択
   - セクター分散を意識
   - 最低2週間のペーパートレード

2. **段階的な拡大**
   - 1ヶ月ごとに1-2銘柄追加
   - パフォーマンスを観察しながら調整
   - 最大でも10銘柄まで（管理容易性）

3. **定期的な見直し**
   - 月次で流動性・ボラティリティを再評価
   - パフォーマンスの悪い銘柄は入れ替え
   - 市場環境変化に応じて柔軟に対応

4. **イベントカレンダーの活用**
   - 決算発表日を事前にチェック
   - 株主総会・配当権利落ち日を把握
   - 3営業日前に自動除外

### 10.2 避けるべき銘柄の特徴

```
❌ 避けるべき銘柄:
  - 過去3ヶ月で50%以上の急騰/急落
  - 出来高が不安定（日によって10倍以上の差）
  - 企業ニュースが頻繁（週1回以上）
  - 信用倍率が極端（10倍超 or 0.1倍未満）
  - 外国人保有比率が極端（80%超 or 5%未満）
  - 個人投資家比率が高い（仕手株の可能性）
```

---

## まとめ

### 推奨銘柄リスト（Top 10）

**全自動売買に最適な銘柄（優先順位順）:**

1. **ソフトバンクG（9984）** - 最高の流動性、適度なボラ
2. **ソニーG（6758）** - グローバル企業、トレンド継続性高
3. **トヨタ自動車（7203）** - 安定性抜群、出来高安定
4. **東京エレクトロン（8035）** - 半導体関連、高ボラ
5. **KDDI（9433）** - ディフェンシブ、低ボラ
6. **三菱UFJ（8306）** - 金融セクター代表、配当安定
7. **キーエンス（6861）** - 高額だが流動性極大
8. **リクルートHD（6098）** - 成長株、値動き活発
9. **信越化学（4063）** - 化学セクター、世界的企業
10. **第一三共（4568）** - 医薬品セクター、景気中立

**セクター分散例（5銘柄保有時）:**
- 通信: ソフトバンクG（9984）
- 電機: ソニーG（6758）
- 自動車: トヨタ（7203）
- 金融: 三菱UFJ（8306）
- サービス: リクルート（6098）

---

*最終更新: 2025-12-27*
